# Default values for dbhub-operator
# This is a YAML-formatted file.

# Operator deployment configuration
replicaCount: 1

image:
  repository: ghcr.io/tributary-ai-services/dbhub-operator
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: ""

podAnnotations: {}

podSecurityContext:
  runAsNonRoot: true
  seccompProfile:
    type: RuntimeDefault

securityContext:
  readOnlyRootFilesystem: true
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# Operator resources
resources:
  limits:
    cpu: 500m
    memory: 256Mi
  requests:
    cpu: 100m
    memory: 128Mi

nodeSelector: {}

tolerations: []

affinity: {}

# Leader election
leaderElection:
  enabled: true

# Webhooks
webhooks:
  enabled: true
  # Use cert-manager for webhook certificates
  certManager:
    enabled: true

# Metrics
metrics:
  enabled: true
  secure: true
  port: 8443

# Health probes
probes:
  port: 8081
  livenessProbe:
    initialDelaySeconds: 15
    periodSeconds: 20
  readinessProbe:
    initialDelaySeconds: 5
    periodSeconds: 10

# Default database settings (applied by webhooks)
defaults:
  database:
    connectionTimeout: 30
    queryTimeout: 60
    maxRows: 1000
    sslMode: disable
  dbhubInstance:
    replicas: 1
    image: bytebase/dbhub:latest
    transport: http
    port: 8080
    policy:
      readOnly: true
      maxRows: 1000
      allowedOperations:
        - execute_sql
        - search_objects

# RBAC
rbac:
  create: true
